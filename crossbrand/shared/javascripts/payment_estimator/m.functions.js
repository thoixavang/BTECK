jQuery.fn.ForceNumericOnly=function(a){a=(typeof(a!="undefined")?a:false);return this.each(function(){jQuery(this).keydown(function(c){var b=((c.shiftKey||c.altKey||c.ctrlKey)?null:c.charCode||c.keyCode||0);if(a){return(b==8||b==9||b==13||b==46||b==110||b==190||(b>=37&&b<=40)||(b>=48&&b<=57)||(b>=96&&b<=105));}else{return(b==8||b==9||b==13||b==46||(b>=37&&b<=40)||(b>=48&&b<=57)||(b>=96&&b<=105));}});});};(function(a){a.extend({number_format:function(m,f){var m=m.toString().replace(",","");var o={numberOfDecimals:0,decimalSeparator:".",thousandSeparator:",",symbol:"",roundUp:false};var s=a.extend(o,f);var g=m;var c=s.numberOfDecimals;var r=s.decimalSeparator;var e=s.thousandSeparator;var l=s.symbol;var d=s.roundUp;var n="";var p=g.toString();var k=p.indexOf("e");if(k>-1){n=p.substring(k);g=parseFloat(p.substring(0,k));}if(c!=null){var q=Math.pow(10,c);g=(d?Math.ceil(g*q)/q:Math.round(g*q)/q);}var b=g<0?"-":"";var j=(g>0?Math.floor(g):Math.abs(Math.ceil(g))).toString();var h=g.toString().substring(j.length+b.length);r=r!=null?r:".";h=c!=null&&c>0||h.length>1?(r+h.substring(1)):"";if(c!=null&&c>0){for(i=h.length-1,z=c;i<z;++i){h+="0";}}e=(e!=r||h.length==0)?e:null;if(e!=null&&e!=""){for(i=j.length-3;i>0;i-=3){j=j.substring(0,i)+e+j.substring(i);}}if(s.symbol==""){return b+j+h+n;}else{return b+l+j+h+n;}}});})(jQuery);(function(a){a.titleCase=function(c){if(typeof(c)!="string"||!c){return null;}var b=c;b=b.replace(/_/g," ");c=b.replace(/([\w&`'''"".@:\/\{\(\[<>_]+-? *)/g,function(e,f,d,g){if(d>0&&g.charAt(d-2)!==":"&&e.search(/^(a(nd?|s|t)?|b(ut|y)|en|for|i[fn]|o[fnr]|t(he|o)|vs?\.?|via)[ \-]/i)>-1){return e.toLowerCase();}if(g.substring(d-1,d+1).search(/['"_{(\[]/)>-1){return e.charAt(0)+e.charAt(1).toUpperCase()+e.substr(2);}if(e.substr(1).search(/[A-Z]+|&|[\w]+[._][\w]+/)>-1||g.substring(d-1,d+1).search(/[\])}]/)>-1){return e;}return e.charAt(0).toUpperCase()+e.substr(1);});return c;};})(jQuery);(function(a){a.pe={debug:false,options:{app:"pe",changeZip:true,changeVehicle:true},setOptions:function(){this.zip=context.zip;this.selectedOptions="";this.offerType="";try{var c="/"+Vehicles.getBrand()+"/en/mobile/";if(pe_vehicle==""&&pe_trim==""){pageTrack("",c+"calculate_payment/index.html",true);}}catch(b){}$.pe.init();},params:{},offers:{buy_offer:{},lease_offer:{},incentives:{}},offersFeed:"/hostd/incentives/getvehicleoffers.json",offerType:{},monthlyPayment:0,down_payment:0,down_payment_override:false,trade_in:0,selectedOptionsTotal:0,d_section:"",cur_section:"",formatInputField:function(b){if(this.debug){console.log("input",b);}return a.number_format(b,{roundUp:true});},formatTwoDecimals:function(b){if(this.debug){console.log("twoDec",b);}return a.number_format(b,{numberOfDecimals:2});},formatCurrency:function(b){if(this.debug){console.log("cur",b);}return a.number_format(b,{symbol:"$",roundUp:true});},cleanNum:function(b){return parseFloat(b.replace(/,|\$/gi,""));},showLoader:function(){a("#payment_estimator").before('<div class="loader"></div>');a("#payment_estimator, .tab").hide().addClass("hide");a(".vehicle_title").html("");},hideLoader:function(){a(".loader").remove();a("#payment_estimator, .tab").hide().removeClass("hide").fadeIn(500);try{a.pe.changeSection("buy");a("#default-apr").trigger("click");a("select").selectmenu().selectmenu("refresh",true);var c="/"+Vehicles.getBrand()+"/en/mobile/"+this.vehicle+"/calculate_payment/index.html";if(typeof(context.ccode)!="undefined"){pageTrack("",c,true);}mobile.updateContextBtns("pe");}catch(b){}},init:function(){if(!context.ccode||!context.llp){var b=mobile.vehObj.getModels(),d=b[0];context.model=d.value;context.ccode=d.ccode;context.llp=d.llp;}this.zip=context.zip;var c={ccode:context.ccode,llp:context.llp};if(!context.ccode||!context.llp||!this.zip){return;}else{try{if(context.year==""){context.year=context.ccode.slice(3,7);}if(context.vehicle==""){context.vehicle=Vehicles.getFamilyFromMYC(context.ccode.slice(0,9));}if(context.model==""){context.model=Vehicles.getTrimFromCcode(context.ccode);}var g=context.year+"/"+context.vehicle+"/"+context.model;g+=(context.drive)?"/"+context.drive:"";g+=(context.cab)?"/"+context.cab:"";this.vehicle=g;this.fullVehicle=g.replace(/\//g,"_");}catch(f){this.vehicle=this.fullVehicle="";}this.showLoader();this.getFeed(this.offersFeed,c);try{mobile.updateContextBtns("pe");$("#peInner .context").removeClass("hide");mobile.updateVehContext();}catch(f){}}a(".buy_tab").css("visibility","visible");},getFeed:function(c,h){try{var g=this,b="?zip="+this.zip;if(!c){return null;}for(var f in h){b+="&"+f+"="+h[f];}a.getJSON(c+b,function(k){g.offers={buy_offer:{},lease_offer:{},incentives:{}};g.forceCashOffer=false;g.feed=k.result.data;for(var j in g.feed.purchases){if(!isNaN(j)){(g.feed.purchases[j].type=="lease")?g.offers.lease_offer=g.feed.purchases[j]:(g.feed.purchases[j].type=="apr")?g.offers.buy_offer=g.feed.purchases[j]:(g.feed.purchases[j].type=="cash")?g.offers.cash_offer=g.feed.purchases[j]:"";}}for(var e in g.feed.incentives){if(!isNaN(e)){g.offers.incentives[g.feed.incentives[e].incid]=g.feed.incentives[e];}}if(objectSize(g.offers.buy_offer)==0){g.forceCashOffer=true;g.populateCashOffer();}g.funcs();});}catch(d){return false;}},funcs:function(){this.offers_is_loaded=false;try{this.pageSetup();this.offers_is_loaded=true;this.inputFieldsHandler();}catch(b){if(this.debug){console.log(b);}this.failed(b);}this.buttonHandler();this.hideLoader();this.delegateChange();},delegateChange:function(){a("select[name='lease-term']").change(function(){a("#payment_estimator #down_payment input").blur();});a("select[name='annual-miles']").change(function(){a("#payment_estimator #trade_in_value input").blur();});},populateCashOffer:function(){var b;if(typeof(this.offers.cash_offer)=="object"){b={rateIncentive:{rate:6.47},additiveIncentives:this.offers.cash_offer.terms[0].offer.additiveIncentives,type:this.offers.cash_offer.terms[0].offer.type};}else{this.offers.cash_offer={};b={rateIncentive:{rate:6.47},type:"custom_apr"};}this.offers.cash_offer.terms_list=this.offers.cash_offer.terms={12:{duration:12,offer:b},24:{duration:24,offer:b},36:{duration:36,offer:b},48:{duration:48,offer:b},60:{duration:60,offer:b},72:{duration:72,offer:b}};this.offers.cash_offer.defaultTerm=72;if(this.forceCashOffer===true){this.offers.buy_offer.terms_list=this.offers.buy_offer.terms=this.offers.cash_offer.terms;this.offers.buy_offer.defaultTerm=this.offers.cash_offer.defaultTerm;}},changeSection:function(c){a(".down_pay").removeClass("errorHilight");a("#payment_estimator #trade_in_value input").removeClass("errorHilight");a("#payment_estimator #total .form-block-err-msg").addClass("hide");this.cur_section=c;switch(c){case"lease":a("#payment_estimator").find("#total").find(".title").text("Adjusted capitalized cost").end().end().find("#estimator_offer .title .tooltip").removeData("ttip").attr("title","This lease rate is for estimation purposes only. You may not be able to lease your vehicle at this rate. A security deposit may be required. See dealer for details.");break;case"buy":a("#payment_estimator").find("#total").find(".title").text("Estimated selling price").end().end().find("#estimator_offer .title .tooltip").removeData("ttip").attr("title","This rate is for estimation purposes only. You may not be able to finance your vehicle at this rate. See dealer for details.");break;}if(this.offers_is_loaded!=false){var b=parseFloat(a("#payment_estimator #"+c+"_term select option:selected").attr("value"));this.populateBC(c,b);this.updateTotal(c);}var g=(c=="lease")?"buy":"lease";a("."+g+"_tab").removeClass("tab_on");a("."+c+"_tab").addClass("tab_on");a("."+g+"_only").addClass("hide");a("."+c+"_only").removeClass("hide");if(a.pe.options.calling_app!=="sni"&&a.pe.options.calling_app!=="bmo"){if(c=="buy"){try{var d=($.cookie("buy_apr"))?$.cookie("buy_apr"):"";if(d=="custom-apr"){a("#payment_estimator #apr #custom-apr").click();}else{if(d=="std-apr"){a("#payment_estimator #apr #default-apr").click();}}}catch(f){}}else{if(c=="lease"){a.pe.updateValue("trade_in",a("#payment_estimator #trade_in_value input").val());}}}try{moible.updateDisclaimers();}catch(f){}},populateBC:function(o,m){o=o+"_offer";this.offers[o].bc=[];this.offers[o].bc_amount=0;var c=this.offers[o].terms_list[m].offer.additiveIncentives,j=0,g=this;if(c!=null){for(var p in c.additiveIncentives){if(!isNaN(p)){var b=this.offers.incentives[c.additiveIncentives[p]];this.offers[o].bc[j]={type:b.type,programName:b.programName,programCode:b.programCode,startDate:b.startDate,endDate:b.endDate,value:b.value,disclaimer:b.upicDisclaimer};j++;}}}for(var d in g.offers[o].bc){if(!isNaN(d)){g.offers[o].bc_amount+=g.offers[o].bc[d].value;switch(g.offers[o].bc[d].type){case"misc_bonus_cash":var q="Bonus Cash";break;case"customer_cash":var q="Customer Cash";break;case"gmac_bonus_cash":var q="Ally Bonus";break;default:var q="Bonus Cash";break;}var k=g.offers[o].bc[d].programCode,v=(typeof(g.offers[o].bc[d].disclaimer)!="undefined")?g.offers[o].bc[d].disclaimer:"",h=g.formatCurrency(-g.offers[o].bc[d].value),w=a("#pe-disclaimers"),l=a('<div class="'+k+" "+o+" "+m+' hide"><span class="title">'+h+" "+q+" - "+k+'</span><span class="disclaimer-txt">'+v+"</span></div>");g.offers[o].bc_array=[];g.offers[o].bc_array.push(k+"_"+g.offers[o].bc[d].value);if(w.find("."+k+"."+o+"."+m).length<=0){a(w).append(l);}}}var n=(a("#pe-disclaimers ."+o+"."+m).length)?a("#pe-disclaimers ."+o+"."+m):"",u="";if(o=="cash_offer"){this.offers.buy_offer.bc_amount=this.offers.cash_offer.bc_amount;}if(n.length>0){for(var p in n){if(!isNaN(p)){u+=a(n[p]).html();}}a("#payment_estimator #sellingCost").find(".disclaimer-text").removeClass("hide").end().find(".tooltip").removeClass("hide").removeData("ttip").attr("title",u);a("#payment_estimator #incentives").removeClass("hide").find(".inject .num").text(g.formatCurrency(-g.offers[o].bc_amount)).end().find(".inject .disclaimer-text").html('<sup class="tooltip" title="There is a current qualifying cash offer on the vehicle you selected. These discounts have been applied to the Estimated Selling Price.">+</sup>');if(o==="buy_offer"||o==="cash_offer"){a("#payment_estimator #estimator_offer_buy").html(g.formatCurrency(-g.offers[o].bc_amount));}if(o==="lease_offer"){a("#payment_estimator #estimator_offer_lease").html(g.formatCurrency(-g.offers[o].bc_amount));}}else{a("#payment_estimator #sellingCost .disclaimer-text, #payment_estimator #incentives").addClass("hide");a("#payment_estimator #incentives .disclaimer-text").html("");}var f=g.formatCurrency(-g.offers[o].bc_amount);try{mobile.updateDisclaimers();}catch(r){}return f;},pageSetup:function(){this.complete="no";a(".vehicle_title").html(this.feed.vehicle.year+" "+(this.feed.vehicle.division=="RAM TRUCK"?"":this.feed.vehicle.division)+" "+this.feed.vehicle.description);this.feed.vehicle.family=Vehicles.getFamilyFromMYC(this.feed.vehicle.ccode.substr(0,9));if(this.feed.vehicle.configuredPrice!=this.feed.vehicle.basePrice&&this.options.calling_app!="bmo"){this.selectedOptionsTotal=this.feed.vehicle.configuredPrice-this.feed.vehicle.basePrice;a("#selected_options").show().find("span.inject").html(this.formatCurrency(this.selectedOptionsTotal));}a("#payment_estimator #dest_charge span.inject").html(this.formatCurrency(this.feed.vehicle.desCharge)).data("value",this.feed.vehicle.desCharge);this.feed.vehicle.msrp_dest=(this.feed.vehicle.basePrice+this.feed.vehicle.desCharge+this.selectedOptionsTotal);this.feed.vehicle.net_price=this.feed.vehicle.msrp_dest;a("#payment_estimator #dest_charge").removeClass("hide");a("#payment_estimator #base_msrp span.inject").html(this.formatCurrency(this.feed.vehicle.basePrice)).data("value",this.feed.vehicle.basePrice);this.down_payment=Math.ceil(this.feed.vehicle.msrp_dest*0.15);a("#payment_estimator #down_payment .down_pay").attr("value",this.formatInputField(this.down_payment)).attr("data-value",this.down_payment);this.trade_in=0;a('input[name="trade-in"]').attr("value",this.formatInputField(this.trade_in)).attr("data-value",this.trade_in);a("#payment_estimator #incentives").addClass("hide");a("#pe-disclaimers").empty();if(this.options.calling_app!="bmo"&&this.forceCashOffer!=true){a("#default-apr").attr("checked",true);}if(this.cur_section=="buy"){if(typeof(this.offers.lease_offer.type)!="undefined"){this.populateTerms("lease");this.populateMileage();this.updateTotal("lease");}this.populateTerms("buy");this.complete="yes";this.updateTotal("buy");}else{this.populateTerms("buy");if(typeof(this.offers.lease_offer.type)=="undefined"){this.complete="yes";}this.updateTotal("buy");if(typeof(this.offers.lease_offer.type)!="undefined"){this.populateTerms("lease");this.populateMileage();this.complete="yes";this.updateTotal("lease");}}a("#payment_estimator #total span.inject .num").text(this.formatCurrency(this.feed.vehicle.net)).data("value",this.feed.vehicle.net);a("#estimated_selling_price input").attr("value",this.formatInputField(this.feed.vehicle.net));this.handleNegPayment();},sortTerms:function(d,c){return d.duration-c.duration;},populateTerms:function(h){var g=this,e="",f=[],b=0;this.offers[h+"_offer"].terms_list={};for(var d in this.offers[h+"_offer"].terms){if(!isNaN(d)){b++;f.push(g.offers[h+"_offer"].terms[d]);}}f.sort(this.sortTerms);f=f.slice(0,b);if(typeof(this.offers[h+"_offer"].defaultTerm)=="undefined"){if(f[b-1].offer.basePayment>f[b-2].offer.basePayment){this.offers[h+"_offer"].defaultTerm=f[b-2].duration;}else{this.offers[h+"_offer"].defaultTerm=f[b-1].duration;}}for(var c in f){if(!isNaN(c)){g.offers[h+"_offer"].terms_list[f[c].duration]=(f[c]);}}a.each(this.offers[h+"_offer"].terms_list,function(l,j){e+=("<option id='"+h+"_months_"+l+"' value='"+l+"'>"+l+" months</option>");});a("#payment_estimator #"+h+"_term select").html(e);document.pe.elements[h+"-term"].value=a.pe.offers[h+"_offer"].defaultTerm;this.changeTerm(h,this.offers[h+"_offer"].defaultTerm);},populateMileage:function(d){var g=this,e=[],f=[],b=[];if(d==""||typeof(d)=="undefined"){d=this.offers.lease_offer.defaultTerm;}var j=this.offers.lease_offer.terms_list[d].offer.residualIncentive.incid;for(var k in this.offers.incentives[j].terms){if(!isNaN(k)&&g.offers.incentives[j].terms[k].duration==d){e.push(g.offers.incentives[j].terms[k].mileage+"|"+g.offers.incentives[j].terms[k].value);}}e=e.sort();a.each(e,function(l){if(a.inArray(e[l],f)==-1){f.push(e[l]);}});a("#payment_estimator #annual_miles select").empty();var c=[];a.each(f,function(m,l){a("#payment_estimator #annual_miles select").append(a("<option></option>").attr("value",l.split("|")[0]).text(a.number_format(l.split("|")[0])+" Miles").data("residual",l.split("|")[1]));b.push(l.split("|")[0]);c.push(l.split("|")[0]);});var h=0;if(a.pe.options.calling_app!=="sni"&&a.pe.options.calling_app!=="bmo"){h=($.cookie("annual_miles"))?$.cookie("annual_miles"):"";}if(a.inArray(h,c)!=-1){a("#payment_estimator #annual_miles select option[value="+h+"]").attr("selected",true);g.offers.lease_offer.residual=parseFloat(a("#payment_estimator #annual_miles select option:selected").data("residual"));}else{a("#payment_estimator #annual_miles select option[value="+this.offers.lease_offer.mileage_default+"]").attr("selected",true);g.offers.lease_offer.residual=parseFloat(a("#payment_estimator #annual_miles select option:selected").data("residual"));}a("#payment_estimator #annual_miles select").bind("change",function(){g.offers.lease_offer.residual=parseFloat(a("#payment_estimator #annual_miles select option:selected").data("residual"));g.updateTotal("lease");});return b;},populateAPR:function(b){if(!a("#payment_estimator #apr input:radio:last").attr("checked")){a("#payment_estimator #apr input:radio:first").attr("checked",true);}a("#payment_estimator #apr > div > .inject").html(this.offers[b+"_offer"].terms_list[this.params.term].offer.rateIncentive.rate);},changeTerm:function(f,c){var d=a("#payment_estimator #apr div:first"),b=d.find("input"),e=d.find('span:not(".rateNotAvailable"), sup');if(f=="lease"){this.offers.lease_offer.residual=(this.offers.lease_offer.terms_list[c].offer.residualIncentive.rate)?this.offers.lease_offer.terms_list[c].offer.residualIncentive.rate:a("#annual_miles select option:selected").data("residual");}this.offers[f+"_offer"].rate=this.offers[f+"_offer"].terms_list[c].offer.rateIncentive.rate;this.offers[f+"_offer"].offerType=this.offers[f+"_offer"].terms_list[c].offer.type;if(f=="buy"&&document.pe.elements["buy-apr"][1].checked==true){this.offers[f+"_offer"].rate=parseFloat(document.pe.elements["custom-apr-text"].value);if(typeof(this.offers.cash_offer)=="object"){this.populateBC("cash",c);this.offers[f+"_offer"].offerType=this.offers.cash_offer.terms_list[c].offer.type;if(this.forceCashOffer==true){if(d.find(".rateNotAvailable").length<=0){d.append('<span class="rateNotAvailable"></span>');}d.find(".rateNotAvailable").text(this.chryslerRateNotAvailable(c));b.attr("disabled",true);e.addClass("hide");}}else{this.offers[f+"_offer"].offerType="custom_apr";}}else{if(f=="buy"&&document.pe.elements["buy-apr"][1].checked==true){this.offers[f+"_offer"].offerType="custom_apr";}this.populateBC(f,c);d.find(".rateNotAvailable").remove();b.attr("disabled",false);e.removeClass("hide");a("input[name=custom-apr-text]").attr("disabled",true);}this.updateTotal(f);if(f=="lease"&&typeof(this.offers.lease_offer.type)!="undefined"){this.populateMileage(c);}else{this.populateAPR(f);}},inputFieldsHandler:function(){var b=this;a("input.dollar").ForceNumericOnly().keypress(function(c){if(c.keyCode==13){a(this).trigger("blur");}});a("input.dollar").bind("keyup",function(){a(this).val(b.formatInputField(a(this).val().replace(",","")));});a("#payment_estimator #apr input").ForceNumericOnly(true).keypress(function(c){if(c.keyCode==13){a(this).trigger("blur");}});a("input[name=custom-apr-text]").val(6.47).bind("blur",function(){var c=6.47;if(a(this).val()==""){a(this).val(c);}b.offers.buy_offer.rate=parseFloat(a(this).val());b.updateTotal("buy");}).keypress(function(c){if(c.keyCode==13){a(this).trigger("blur");}});if(b.offerType=="cash_allowance"||b.offerType=="misc_cash"||b.offerType=="custom_apr"||b.offers.buy_offer.offerType=="custom_apr"){document.pe.elements["buy-apr"][1].checked=true;a.pe.setAPR("custom-apr");}},chryslerRateNotAvailable:function(b){return"No Chrysler rate is available for "+b+" months.";},setAPR:function(c){var b=a("input[name=custom-apr-text]"),d=a("#payment_estimator #default-apr");if(c=="custom-apr"){if(typeof(this.offers.cash_offer)=="object"&&objectSize(this.offers.cash_offer.terms_list)==0){a.pe.populateCashOffer();}b.attr("disabled",false);a.pe.offers.buy_offer.rate=parseFloat(document.pe.elements["custom-apr-text"].value);}else{b.attr("disabled",true);a.pe.offers.buy_offer.rate=a.pe.offers.buy_offer.terms_list[a.pe.params.term].offer.rateIncentive.rate;}a.pe.params.rate=a.pe.offers.buy_offer.rate;a.pe.changeTerm("buy",a.pe.params.term);},updateValue:function(b,c){try{a(".down_pay").removeClass("errorHilight");a("#payment_estimator #trade_in_value input").removeClass("errorHilight");a("#payment_estimator #total .form-block-err-msg").addClass("hide");c=this.cleanNum(c);this[b]=c;a("#payment_estimator #"+b+" input").attr("data-value",c);if(this.cur_section=="buy"){if(typeof(this.offers.lease_offer.type)!="undefined"){this.updateTotal("lease");}this.updateTotal("buy");}else{this.updateTotal("buy");if(typeof(this.offers.lease_offer.type)!="undefined"){this.updateTotal("lease");}}}catch(d){}},updateDownPercent:function(c){var b=(c/this.feed.vehicle.msrp_dest*100);(b>=100)?(b=15):(b!=15)?this.down_payment_override=true:this.down_payment_override=false;a("#payment_estimator #down_payment .down_percent").html("("+Math.round(b)+"%)");this.downPayPercent=Math.round(b);},updateTotal:function(b){this.feed.vehicle.net=(this.feed.vehicle.msrp_dest-this.offers[b+"_offer"].bc_amount-this.trade_in-this.down_payment);this.feed.vehicle.net_price=(this.feed.vehicle.msrp_dest-this.offers[b+"_offer"].bc_amount);this.updateMonthlyPayment(b);a("#payment_estimator #total span.inject .num").text(this.formatCurrency(this.feed.vehicle.net));a("#payment_estimator #estimated_selling_price input").data("value",this.feed.vehicle.net).attr("value",this.formatInputField(this.feed.vehicle.net));if((a("#payment_estimator #sellingCost .num").html().indexOf("-")!=-1)||(a("#payment_estimator #estimator_offer .inject").html().indexOf("-")!=-1)){a("#payment_estimator #sellingCost .num").html("--");a("#payment_estimator #estimator_offer .inject").html("--");a(".tab_on span").html("--");a("#payment_estimator #sellingCost .disclaimer-text").hide();}else{a("#payment_estimator #sellingCost .disclaimer-text").show();}},resetForm:function(){if(this.complete=="yes"){a(".down_pay, #payment_estimator #trade_in_value input").addClass("errorHilight");a("#payment_estimator #total .form-block-err-msg").html("The total for your Down Payment and Trade In Value <strong>cannot exceed the estimated selling price.</strong> Please adjust one or all values to view estimates.").removeClass("hide");}},failed:function(c){console.log(c);var b=a('<div class="error-msg"><h3>We\'re sorry, but the Calculate Payment tool is currently unavailable.</h3><h4>Please check back later. We apologize for this inconvenience.</h4></div>');a(".tab, .lease_tab, .buy_tab, .context-menu").addClass("hide");a(".tab, .lease_tab, .buy_tab").hide().css("visibility","hidden");if(a("#content .error-msg").length<1){a(b).insertBefore("#payment_estimator");}a("#payment_estimator").remove();},updateMonthlyPayment:function(g){if(typeof(this.offers[g+"_offer"])=="object"){this.params.term=parseFloat(a("#"+g+"_term select option:selected").attr("value"));this.params.rate=this.offers[g+"_offer"].rate;if(this.options.calling_app=="sni"){this.params.vehiclePrice=(this.feed.vehicle.basePrice+this.feed.vehicle.desCharge)-this.offers[g+"_offer"].bc_amount;}else{this.params.vehiclePrice=(this.feed.vehicle.basePrice+this.feed.vehicle.desCharge+this.selectedOptionsTotal)-this.offers[g+"_offer"].bc_amount;}this.params.destination=0;this.params.tradeInValue=this.trade_in;this.params.downPayment=this.down_payment;var d="";for(var c in a.pe.offers.buy_offer.bc_array){if(!isNaN(c)){if(c!=a.pe.offers.buy_offer.bc_array.length-1){d+=(a.pe.offers.buy_offer.bc_array[c]+" | ");}else{d+=a.pe.offers.buy_offer.bc_array[c];}}}var b=(!!a("#default-apr").attr("checked"))?"chrysler":"3rd_party";switch(g){case"buy":this.monthlyPayment=net.autodata.chrysler.pe.PaymentCalculator.getFinancePayment(this.params);a(".buy_tab span").html("("+this.formatCurrency(this.monthlyPayment.payment)+")");var f={a1:"buy_"+a.pe.fullVehicle,a2:"updatePayment",a3:this.feed.vehicle.basePrice,a4:this.selectedOptionsTotal+" | "+this.feed.vehicle.desCharge,a5:this.down_payment,a6:this.trade_in,a7:this.params.term+" | "+b+"_"+this.params.rate.toString().replace(".","_"),a8:d,a9:this.feed.vehicle.net,a10:parseInt(this.monthlyPayment.payment)};if(this.cur_section=="buy"&&this.complete=="yes"){linkTrack(f);}break;case"lease":this.params.residual=parseFloat(this.offers.lease_offer.residual);this.monthlyPayment=net.autodata.chrysler.pe.PaymentCalculator.getLeasePayment(this.params);a(".lease_tab span").html("("+this.formatCurrency(this.monthlyPayment.payment)+")");var e={a1:"lease_"+a.pe.fullVehicle,a2:"updatePayment",a3:this.feed.vehicle.basePrice,a4:this.selectedOptionsTotal+" | "+this.feed.vehicle.desCharge,a5:this.down_payment,a6:this.trade_in,a7:this.params.term+" | "+a("#payment_estimator #annual_miles select option:selected").text(),a8:d,a9:this.feed.vehicle.net,a10:parseInt(this.monthlyPayment.payment)};if(this.cur_section=="lease"&&this.complete=="yes"){linkTrack(e);}break;}a("#payment_estimator #estimator_offer .inject").html(this.formatCurrency(this.monthlyPayment.payment));}else{a("."+g+"_tab").css("visibility","hidden");}this.updateDownPercent(this.down_payment);this.handleNegPayment();},handleNegPayment:function(){var b=this;a(".tab").each(function(){var d=a(this);var c=d.attr("data-section");if(d.find("span").text().indexOf("-")>-1){if(c==b.cur_section){b.resetForm();}else{d.parent(".ui-radio").css("visibility","hidden");}}else{if(typeof(a.pe.offers.lease_offer.type)!="undefined"){a(".tab").parent(".ui-radio").css("visibility","visible");}}});},buttonHandler:function(){if(typeof(this.offers.lease_offer.type)=="undefined"){a(".lease_tab").css("visibility","hidden");}},parseJSON:function(b){if(typeof b!=="string"||!b){return null;}b=a.trim(b);if(/^[\],:{}\s]*$/.test(b.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){return window.JSON&&window.JSON.parse?window.JSON.parse(b):(new Function("return "+b))();}}};})(jQuery);function objectSize(b){var a=0;for(var c in b){a++;}return a;}(function(b){try{b.pe.anametrixPath=anametrixPath;}catch(a){console.log(a);}b("#pe-container").addClass("pe").parent("#content").addClass("pe");})(jQuery);